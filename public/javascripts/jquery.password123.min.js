/*
 * jQuery password123: iPhone Style Passwords Plugin - v1.1 - 7/5/2010
 * http://timmywillison.com/samples/password123/
 * 
 * Copyright (c) 2010 timmy willison
 * Dual licensed under the MIT and GPL licences.
 * http://timmywillison.com/licence/
 */
(function(f,i,j,d){var b,m,a={character:"&#8226;",delay:2000,prefix:"iField",placeholder:true,placeholderClass:"place",maskPlaceholder:false};f.event.special.textchange={setup:function(o,n){f(this).bind("keyup.textchange",f.event.special.textchange.handler);f(this).bind("cut.textchange paste.textchange input.textchange",f.event.special.textchange.delayedHandler)},teardown:function(n){f(this).unbind(".textchange")},handler:function(n){f.event.special.textchange.triggerIfChanged(f(this))},delayedHandler:function(o){var n=f(this);setTimeout(function(){f.event.special.textchange.triggerIfChanged(n)},25)},triggerIfChanged:function(n){var p=n.val(),o=f("<div>"+a.character+"</div>").text();if(n.val()!==n.data("lastValue")){if(p.length>1&&p.indexOf(o)===-1){p=p.substr(0,p.length-1);n.data("value",p).prev("input").val(p)}n.trigger("textchange",n.data("lastValue"));n.data("lastValue",n.val())}}};f.fn.textchange=function(n){return n?this.bind("textchange",n):this.trigger("textchange")};if(f.attrFn){f.attrFn.textchange=true}function l(o){if(o!=null){if(j.selection){o.focus();var n=j.selection.createRange();n.moveStart("character",-o.value.length);return n.text.length}else{if(o.selectionStart||o.selectionStart=="0"){return o.selectionStart}else{return -1}}}}function e(o,p){if(o!=null){if(o.createTextRange){var n=o.createTextRange();n.move("character",p);n.select()}else{if(o.selectionStart){o.focus();o.setSelectionRange(p,p)}else{o.focus()}}}}function h(o){var n=[];f(o).each(function(r,q){var t=f(q),s=a.prefix+r,p=t.attr("placeholder")||t.attr("value");f('<input type="text"/>').attr({"class":a.placeholder?t.attr("class")+" "+a.placeholderClass:t.attr("class"),id:s,value:p}).insertAfter(t).data("placeholder",p);n.push(j.getElementById(s));f('<input type="hidden"/>').attr({name:t.attr("name"),id:t.attr("id"),"class":t.attr("class")}).replaceAll(t).val(p)});return f(n).data("value","")}function g(){var p=f(this);var s=p.val();if(s.length>p.data("value").length){p.data("value",k(p))}else{if(s.length<p.data("value").length){i.clearTimeout(m);var q=p.prev("input"),n=q.val(),o;if(s.length<n.length-1){o=n.substr(0,s.length)}else{var r=l(p[0]);o=n.length>r+1&&r>-1?n.slice(0,r).concat(n.slice(r+1)):n.slice(0,r)}p.data("value",s).prev("input").val(o)}}}function k(v){i.clearTimeout(m);var p=v.val(),s=p.length,r=v.prev("input"),o=r.val(),u=l(v[0]),t=f("<div>"+a.character+"</div>").text(),n;n=o.length>u+1&&u>-1?o.substr(0,u-1)+p.charAt(u-1)+o.substr(u-1):o+p.charAt(s-1);r.val(n);if(s>1){for(var q=0;q<s-1;q++){p=p.replace(p.charAt(q),t)}v.val(p)}if(s>0){m=setTimeout(function(){u=l(v[0]);p=v.val();p=p.replace(p.charAt(s-1),t);v.val(p).data("value",p);if(u!=s){e(v[0],u)}},a.delay)}if(u!=s){e(v[0],u)}return p}function c(n){n.focus(function(){var p=f(this),q=p.prev("input"),o=p.data("placeholder");if(o!=d&&q.val()===o){p.val("").removeClass(a.placeholderClass);q.val("")}}).blur(function(){var p=f(this),o=p.data("placeholder");if(o!=d&&p.val()===""){p.val(o).addClass(a.placeholderClass).prev("input").val(o).end();if(a.maskPlaceholder){p.keyup()}}});if(a.maskPlaceholder){n.keyup()}}f.fn.password123=function(n){a=jQuery.extend(a,n);b=h(this);b.textchange(g);if(a.placeholder){c(b)}else{if(a.maskPlaceholder){b.keyup()}}return b}})(jQuery,this,document);